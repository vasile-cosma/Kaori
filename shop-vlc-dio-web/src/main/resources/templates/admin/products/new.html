<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>Nueva categoría</title>
    <link th:replace="~{fragments/styles::styles}">
</head>
<body>

<header th:replace="~{fragments/header::header}"></header>
<div class="mb-5">
    <h1 th:replace="~{fragments/hero::hero('Nuevo producto')}"></h1>
</div>



<form method="post" id="myForm" class="needs-validation" th:object="${product}">
    <div class="container">
        <div class="mb-3">
            <label for="code" class="form-label">Código de producto</label>
            <input type="number" class="form-control has-validation" id="code" aria-describedby="textHelp" th:field="*{code}" th:text="${product.code}">
            <div class="invalid-feedback">
                Solo se admiten números.
            </div>
        </div>
        <div class="mb-3">
            <label for="name" class="form-label">Nombre</label>
            <input type="text" class="form-control" id="name" aria-describedby="textHelp" th:field="*{name}" th:text="${product.name}">
        </div>
        <div class="mb-3">
            <label for="description" class="form-label">Descripción</label>
            <textarea class="form-control" id="description" rows="3" th:field="*{description}" th:text="${product.description}"></textarea>
        </div>
        <fieldset class="mb-3">
            <legend class="mt-3 ">Categorías</legend>
            <div class="row">
                <div class="form-check col-2 ps-5" style="accent-color: #7faf51" th:each="category: ${categories}">
                    <input type="checkbox"
                           id="category-check"
                           th:field="*{categoriesIds}"
                           th:value="${category.id}"
                           th:id="|'category-check'${category.id}|">

                    <label class="form-check-label"
                           for="category-check"
                           th:for="|'category-check'${category.id}|"
                           th:text="${category.name}">
                        Categoría
                    </label>
                </div>
            </div>
        </fieldset>

        <div class="mb-3 mt-3">
            <label for="price" class="form-label">Precio</label>
            <input type="number" class="form-control" id="price" aria-describedby="numberHelp" th:field="*{price}" th:text="${product.price}">
            <div class="invalid-feedback">
                Solo se admiten números.
            </div>
        </div>
        <div class="mb-3">
            <label for="discount" class="form-label">Descuento</label>
            <input type="number" class="form-control" id="discount" aria-describedby="numberHelp" th:field="*{discount}" th:text="${product.discount}">
            <div class="invalid-feedback">
                Solo se admiten números.
            </div>
        </div>

        <button type="submit" class="btn text-light mt-3" style="background-color: #7faf51">Submit</button>
        <a type="submit" class="btn btn-danger mt-3" th:href="@{/admin/products}">Volver</a>-->
        <div class="row pb-3 d-flex">
            <label for="brand-id" class="form-label ms-3">Marca</label>
            <select class="form-select border rounded-2 text-dark ms-4" id="brand-id" th:field="*{brandId}">
                <option class="text-dark" value="">Seleccione...</option>
                <option class="text-dark" th:each="brand: ${brands}"
                        
                        th:value="${brand.id}"
                        th:text="${brand.name}">Marca</option>
            </select>
        </div>

        <div class="d-flex justify-content-end gap-2">
            <button type="submit" class="btn text-light mt-3" style="background-color: #7faf51">Submit</button>
            <a class="btn btn-danger mt-3" th:href="@{/admin/products}">Volver</a>
        </div>
    </div>
</form>

<div class="mt-5"><footer th:replace="~{fragments/footer::footer}"></footer></div>
<div th:replace="~{fragments/scripts::scripts}"></div>
<script>
    // Obtener formulario y campos
    const form = document.getElementById("myForm");
    const campos = form.querySelectorAll("input");


    // Validación en tiempo real
    campos.forEach((campo) => {
        campo.addEventListener("input", () => {
            if (campo.checkValidity()) {
                campo.classList.remove("is-invalid");
                campo.classList.add("is-valid");
            } else {
                campo.classList.remove("is-valid");
                campo.classList.add("is-invalid");
            }
        });
    });

    // Validación al enviar
    form.addEventListener("submit", (e) => {
        if (!form.checkValidity()) {
            e.preventDefault();
            e.stopPropagation();

            campos.forEach((campo) => {
                if (!campo.checkValidity()) {
                    campo.classList.add("is-invalid");
                }
            });
        }
    });
</script>
</body>
</html>